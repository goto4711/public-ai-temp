{"version":3,"file":"@tensorflow-models_knn-classifier.js","names":["KNNClassifier","util.arraysEqual"],"sources":["../../@tensorflow-models/knn-classifier/dist/knn-classifier.esm.js"],"sourcesContent":["/**\n    * @license\n    * Copyright 2023 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport { concat, util, tidy, reshape, keep, matMul, norm, div, cast } from '@tensorflow/tfjs-core';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\n\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nfunction concatWithNulls(ndarray1, ndarray2) {\n    if (ndarray1 == null && ndarray2 == null) {\n        return null;\n    }\n    if (ndarray1 == null) {\n        return ndarray2.clone();\n    }\n    else if (ndarray2 === null) {\n        return ndarray1.clone();\n    }\n    return concat([ndarray1, ndarray2], 0);\n}\nfunction topK(values, k) {\n    var valuesAndIndices = [];\n    for (var i = 0; i < values.length; i++) {\n        valuesAndIndices.push({ value: values[i], index: i });\n    }\n    valuesAndIndices.sort(function (a, b) {\n        return b.value - a.value;\n    });\n    var topkValues = new Float32Array(k);\n    var topkIndices = new Int32Array(k);\n    for (var i = 0; i < k; i++) {\n        topkValues[i] = valuesAndIndices[i].value;\n        topkIndices[i] = valuesAndIndices[i].index;\n    }\n    return { values: topkValues, indices: topkIndices };\n}\n\n/** @license See the LICENSE file. */\n// This code is auto-generated, do not modify this file!\nvar version = '1.2.6';\n\n/**\n * A K-nearest neighbors (KNN) classifier that allows fast\n * custom model training on top of any tensor input. Useful for transfer\n * learning with an embedding from another pretrained model.\n */\nvar KNNClassifier = /** @class */ (function () {\n    function KNNClassifier() {\n        // Individual class datasets used when adding examples. These get concatenated\n        // into the full trainDatasetMatrix when a prediction is made.\n        this.classDatasetMatrices = {};\n        this.classExampleCount = {};\n        this.labelToClassId = {};\n        this.nextClassId = 0;\n    }\n    /**\n     * Adds the provided example to the specified class.\n     */\n    KNNClassifier.prototype.addExample = function (example, label) {\n        var _this = this;\n        if (this.exampleShape == null) {\n            this.exampleShape = example.shape;\n        }\n        if (!util.arraysEqual(this.exampleShape, example.shape)) {\n            throw new Error(\"Example shape provided, \".concat(example.shape, \" does not match \") +\n                \"previously provided example shapes \".concat(this.exampleShape, \".\"));\n        }\n        this.clearTrainDatasetMatrix();\n        if (!(label in this.labelToClassId)) {\n            this.labelToClassId[label] = this.nextClassId++;\n        }\n        tidy(function () {\n            var normalizedExample = _this.normalizeVectorToUnitLength(reshape(example, [example.size]));\n            var exampleSize = normalizedExample.shape[0];\n            if (_this.classDatasetMatrices[label] == null) {\n                _this.classDatasetMatrices[label] =\n                    reshape(normalizedExample, [1, exampleSize]);\n            }\n            else {\n                var newTrainLogitsMatrix = concat([\n                    reshape(_this.classDatasetMatrices[label], [_this.classExampleCount[label], exampleSize]),\n                    reshape(normalizedExample, [1, exampleSize])\n                ], 0);\n                _this.classDatasetMatrices[label].dispose();\n                _this.classDatasetMatrices[label] = newTrainLogitsMatrix;\n            }\n            keep(_this.classDatasetMatrices[label]);\n            if (_this.classExampleCount[label] == null) {\n                _this.classExampleCount[label] = 0;\n            }\n            _this.classExampleCount[label]++;\n        });\n    };\n    /**\n     * This method return distances between the input and all examples in the\n     * dataset.\n     *\n     * @param input The input example.\n     * @returns cosine similarities for each entry in the database.\n     */\n    KNNClassifier.prototype.similarities = function (input) {\n        var _this = this;\n        return tidy(function () {\n            var normalizedExample = _this.normalizeVectorToUnitLength(reshape(input, [input.size]));\n            var exampleSize = normalizedExample.shape[0];\n            // Lazily create the logits matrix for all training examples if necessary.\n            if (_this.trainDatasetMatrix == null) {\n                var newTrainLogitsMatrix = null;\n                for (var label in _this.classDatasetMatrices) {\n                    newTrainLogitsMatrix = concatWithNulls(newTrainLogitsMatrix, _this.classDatasetMatrices[label]);\n                }\n                _this.trainDatasetMatrix = newTrainLogitsMatrix;\n            }\n            if (_this.trainDatasetMatrix == null) {\n                console.warn('Cannot predict without providing training examples.');\n                return null;\n            }\n            keep(_this.trainDatasetMatrix);\n            var numExamples = _this.getNumExamples();\n            return reshape(matMul(reshape(_this.trainDatasetMatrix, [numExamples, exampleSize]), reshape(normalizedExample, [exampleSize, 1])), [numExamples]);\n        });\n    };\n    /**\n     * Predicts the class of the provided input using KNN from the previously-\n     * added inputs and their classes.\n     *\n     * @param input The input to predict the class for.\n     * @returns A dict of the top class for the input and an array of confidence\n     * values for all possible classes.\n     */\n    KNNClassifier.prototype.predictClass = function (input, k) {\n        if (k === void 0) { k = 3; }\n        return __awaiter(this, void 0, void 0, function () {\n            var knn, kVal, topKIndices, _a;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (k < 1) {\n                            throw new Error(\"Please provide a positive integer k value to predictClass.\");\n                        }\n                        if (this.getNumExamples() === 0) {\n                            throw new Error(\"You have not added any examples to the KNN classifier. \" +\n                                \"Please add examples before calling predictClass.\");\n                        }\n                        knn = tidy(function () { return cast(_this.similarities(input), 'float32'); });\n                        kVal = Math.min(k, this.getNumExamples());\n                        _a = topK;\n                        return [4 /*yield*/, knn.data()];\n                    case 1:\n                        topKIndices = _a.apply(void 0, [_b.sent(), kVal]).indices;\n                        knn.dispose();\n                        return [2 /*return*/, this.calculateTopClass(topKIndices, kVal)];\n                }\n            });\n        });\n    };\n    /**\n     * Clears the saved examples from the specified class.\n     */\n    KNNClassifier.prototype.clearClass = function (label) {\n        if (this.classDatasetMatrices[label] == null) {\n            throw new Error(\"Cannot clear invalid class \".concat(label));\n        }\n        this.classDatasetMatrices[label].dispose();\n        delete this.classDatasetMatrices[label];\n        delete this.classExampleCount[label];\n        this.clearTrainDatasetMatrix();\n    };\n    KNNClassifier.prototype.clearAllClasses = function () {\n        for (var label in this.classDatasetMatrices) {\n            this.clearClass(label);\n        }\n    };\n    KNNClassifier.prototype.getClassExampleCount = function () {\n        return this.classExampleCount;\n    };\n    KNNClassifier.prototype.getClassifierDataset = function () {\n        return this.classDatasetMatrices;\n    };\n    KNNClassifier.prototype.getNumClasses = function () {\n        return Object.keys(this.classExampleCount).length;\n    };\n    KNNClassifier.prototype.setClassifierDataset = function (classDatasetMatrices) {\n        this.clearTrainDatasetMatrix();\n        this.classDatasetMatrices = classDatasetMatrices;\n        for (var label in classDatasetMatrices) {\n            this.classExampleCount[label] = classDatasetMatrices[label].shape[0];\n        }\n    };\n    /**\n     * Calculates the top class in knn prediction\n     * @param topKIndices The indices of closest K values.\n     * @param kVal The value of k for the k-nearest neighbors algorithm.\n     */\n    KNNClassifier.prototype.calculateTopClass = function (topKIndices, kVal) {\n        var topLabel;\n        var confidences = {};\n        if (topKIndices == null) {\n            // No class predicted\n            return {\n                classIndex: this.labelToClassId[topLabel],\n                label: topLabel,\n                confidences: confidences\n            };\n        }\n        var classOffsets = {};\n        var offset = 0;\n        for (var label in this.classDatasetMatrices) {\n            offset += this.classExampleCount[label];\n            classOffsets[label] = offset;\n        }\n        var votesPerClass = {};\n        for (var label in this.classDatasetMatrices) {\n            votesPerClass[label] = 0;\n        }\n        for (var i = 0; i < topKIndices.length; i++) {\n            var index = topKIndices[i];\n            for (var label in this.classDatasetMatrices) {\n                if (index < classOffsets[label]) {\n                    votesPerClass[label]++;\n                    break;\n                }\n            }\n        }\n        // Compute confidences.\n        var topConfidence = 0;\n        for (var label in this.classDatasetMatrices) {\n            var probability = votesPerClass[label] / kVal;\n            if (probability > topConfidence) {\n                topConfidence = probability;\n                topLabel = label;\n            }\n            confidences[label] = probability;\n        }\n        return {\n            classIndex: this.labelToClassId[topLabel],\n            label: topLabel,\n            confidences: confidences\n        };\n    };\n    /**\n     * Clear the lazily-loaded train logits matrix due to a change in\n     * training data.\n     */\n    KNNClassifier.prototype.clearTrainDatasetMatrix = function () {\n        if (this.trainDatasetMatrix != null) {\n            this.trainDatasetMatrix.dispose();\n            this.trainDatasetMatrix = null;\n        }\n    };\n    /**\n     * Normalize the provided vector to unit length.\n     */\n    KNNClassifier.prototype.normalizeVectorToUnitLength = function (vec) {\n        return tidy(function () {\n            var sqrtSum = norm(vec);\n            return div(vec, sqrtSum);\n        });\n    };\n    KNNClassifier.prototype.getNumExamples = function () {\n        var total = 0;\n        for (var label in this.classDatasetMatrices) {\n            total += this.classExampleCount[label];\n        }\n        return total;\n    };\n    KNNClassifier.prototype.dispose = function () {\n        this.clearTrainDatasetMatrix();\n        for (var label in this.classDatasetMatrices) {\n            this.classDatasetMatrices[label].dispose();\n        }\n    };\n    return KNNClassifier;\n}());\nfunction create() {\n    return new KNNClassifier();\n}\n\nexport { KNNClassifier, create, version };\n"],"mappings":"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"}